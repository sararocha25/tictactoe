<style>

    @import url('https://fonts.googleapis.com/css?family=Lato|VT323|Indie+Flower');
    
    body {
        background-image: url('http://cdn.backgroundhost.com/backgrounds/subtlepatterns/retina_wood.png');
    }
    
    .container {
        min-width: 650px;
        max-width: 900px;
        display: flex;
        margin: 40px auto 20px auto;    
    }
    
    .gameboard {
        width: 360px;
    }
    
    .center {
        flex-grow: 0;
    }
    
    .row {
        clear: both;
        overflow: hidden;
    }
    
    .square {
        float: left;
        height: 100px;
        width: 117px;
        text-align: center;
        font-size: 80px;
        color: #461F00;
        text-shadow: 1px 1px 0px rgba(255,255,255,0.4);
        font-family: fantasy;
    }
    
    .bottom {
        border-bottom: 4px solid #392E20;
    }
    
    .right {
        border-right: 4px solid #392E20;
    }
    
    .left-side {
        flex-grow: 1;
        display: flex;
        flex-direction: column;
        max-width: 160px;
    }
    
    .right-side {
        font-family: 'Lato';
        flex-grow: 0;
        text-align: center;
        max-width: 340px;
    }
    
    .left-side .row {
        font-size: 50px;
        font-family: 'Indie Flower';
        text-shadow: 1px 1px 0px rgba(255,255,255,0.4);
        padding: 5px;
    }
    
    .score {
        background: black;
        color: red;
        height: 50px;
        font-size: 35px;
        flex-grow: 1;
        margin: 0;
        border-radius: 4px;
        font-family: 'VT323';
        display: flex;
        justify-content: center;
        align-items: center;
        max-width: 57px;
    }
    
    .player {
        display: flex;
        align-items: center;
        height: 100px;
        padding-right: 5px;
    }
    
    .player-name {
        flex-grow: 2;
        text-shadow: 1px 1px 0px rgba(255,255,255,0.4);
    }
    
    .player-turn {
        flex-grow: 2;
    }
    
    .turn {
        flex-grow: 1;
        display: flex;
        justify-content: center;
        width: 43px;
    }
    
    marquee {
        background: black;
        color: red;
        font-family: 'VT323';
        margin-top: 20px;
        display: flex;
        align-items: center;
        height: 30px;
        width: 75%;
        margin-left: 20%;
        margin-right: 5%;
        border-radius: 4px;
    }
    
    a {
        text-decoration: none;
        color: red;
        width: 300px;
    }
    
    input#restart {
        width: 90px;
        margin: 10px 0 20px 0;
    }
    
    div#winner {
        margin-left: 8%;
        margin-top: 20px;
    }
    
    .button {
        position: relative;
        border: none;
        display: inline-block;
        box-shadow: inset 0px 0px 0px 1px rgba(0,0,0,0.2),
        inset 0px -5px 0px 0px rgba(0,0,0,0.3),
        inset 0px 2px 0px 0px rgba(255,255,255,0.5);
        -webkit-border-radius: 5px;
        -moz-border-radius: 5px;
        border-radius: 5px;
        overflow: hidden;
        cursor: pointer;
        width: 90px;
        text-align: center;
    }
    
    .button:active {
        box-shadow: inset 0px 0px 0px 1px rgba(0,0,0,0.2),
        inset 0px -2px 0px 0px rgba(0,0,0,0.3),
        inset 0px 2px 0px 0px rgba(255,255,255,0.5);
        top: 3px;
    }
    
    .button div {
        padding: 10px 20px 12px 20px;
        color: rgba(0,0,0,0.7);
        text-shadow: 1px 1px 0px rgba(255,255,255,0.4);
    }
    
    .button:active div {
        padding-bottom: 9px;
    }
    
    .wood {
        background: url(https://1.bp.blogspot.com/-tXavBQFjNFQ/VMSaYaq7PtI/AAAAAAAADSc/awMPRe3yu5A/s1600/wood_pattern.png);
    }
    
    
    </style>
    
    
    <div class="container">
    
        <div class="left-side">
            <div class="row">Tic</div>
            <div class="row">Tac</div>
            <div class="row">Toe</div>
            <!-- <input type="button" id="restart" value="Restart Game"/> -->
            <!-- <div id="move"></div> -->
            <div class="button wood" id="restart">
                <div>Restart Game</div>
            </div>
            <div id="winner"></div>
        </div>
    
        <div class="center">
            <div class="gameboard">
                <div class="row">
                    <div class="square bottom right" id="c00"></div>
                    <div class="square bottom right" id="c01"></div>
                    <div class="square bottom" id="c02"></div>
                </div>
                <div class="row">
                    <div class="square bottom right" id="c10"></div>
                    <div class="square bottom right" id="c11"></div>
                    <div class="square bottom" id="c12"></div>
                </div>
                <div class="row">
                    <div class="square right" id="c20"></div>
                    <div class="square right" id="c21"></div>
                    <div class="square" id="c22"></div>
                </div>
            </div>
        </div>
    
        <div class="right-side">
            <div class="player">
                <p class="player-name">Player: </p>
                <p class="score" id="score1">0</p>
            </div>
            <div class="player">
                <p class="player-name">Computer: </p>
                <p class="score" id="score2">0</p>
            </div>
            <div class="player">
                <div class="player-turn">Player's turn: </div>  
                <div class="score">
                    <p class="turn"></p>
                </div>
            </div>
            <marquee
              onmouseover="this.stop()"
              onmouseout="this.start()"
              loop="-1"
              behavior="scroll"
              scrollamount="5"
              scrolldelay="0"
              direction="left"
              align="right">
            <a href="https://www.angelopalmieri.com" target="_blank">Designed & Coded by Angelo Palmieri</a><br>
            </marquee>
        </div>
    
    </div>
    
    
    <script>
    
    var board = [
        [null, null, null],
        [null, null, null],
        [null, null, null]
    ]
    
    var myMove = false;
    
    var score1 = 0;
    
    var score2 = 0;
    
    if (myMove) {
        makeMove();
    }
    
    function restartGame() {
        board = [
            [null, null, null],
            [null, null, null],
            [null, null, null]
        ];
        myMove = false;
        $('div').removeClass('notEmpty');
        updateMove();
    }
    
    $(document).ready(function() {
        $(".square").click(function() {
    
            if($(this).hasClass('notEmpty')) {
                console.log('notEmpty');
            } else {
                var cell = $(this).attr("id")
                var row = parseInt(cell[1])
                var col = parseInt(cell[2])
                $(this).addClass('notEmpty');
                if (!myMove) {
                    board[row][col] = false;
                    myMove = true;
                    updateMove();
                    makeMove();
                }
            }
        });
        $("#restart").click(restartGame);
    });
    
    function updateMove() {
        updateButtons();
        
        var winner = getWinner(board);
        
        $("#winner").text(winner == 1 ? "AI Won!" : winner == 0 ? "You Won!" : winner == -1 ? "Tie!" : "");
        
        if(winner == 1) {
            score2++;
            $('#score2').html(score2);
        } else if (winner == 0) {
            score1++;
            $('#score1').html(score1);
        }
    
        $(".turn").html(myMove ? '<i class="fa fa-circle-o" aria-hidden="true"></i>' : '<i class="fa fa-times" aria-hidden="true"></i>');
    
        // if(myMove) {
        //     $(".turn").removeClass('fa fa-times');
        //     $(".turn").addClass('fa fa-circle-o');
        // } else {
        //     $(".turn").removeClass('fa fa-circle-o');
        //     $(".turn").addClass('fa fa-times');
        // }
    }
    
    function getWinner(board) {
       
        // Check if someone won
        vals = [true, false];
        var allNotNull = true;
        for (var k = 0; k < vals.length; k++) {
            var value = vals[k];
            
            // Check rows, columns, and diagonals
            var diagonalComplete1 = true;
            var diagonalComplete2 = true;
            for (var i = 0; i < 3; i++) {
                if (board[i][i] != value) {
                    diagonalComplete1 = false;
                }
                if (board[2 - i][i] != value) {
                    diagonalComplete2 = false;
                }
                var rowComplete = true;
                var colComplete = true;
                for (var j = 0; j < 3; j++) {
                    if (board[i][j] != value) {
                        rowComplete = false;
                    }
                    if (board[j][i] != value) {
                        colComplete = false;
                    }
                    if (board[i][j] == null) {
                        allNotNull = false;
                    }
                }
                if (rowComplete || colComplete) {
                    return value ? 1 : 0;
                }
            }
            if (diagonalComplete1 || diagonalComplete2) {
                return value ? 1 : 0;
                myMove = false;
            }
        }
        if (allNotNull) {
            return -1;
        }
        return null;
    }
        
    function updateButtons() {
        for (var i = 0; i < 3; i++) {
            for (var j = 0; j < 3; j++) {
                $("#c" + i + "" + j).text(board[i][j] == false ? "x" : board[i][j] == true ? "o" : "");
                if (board[i][j] == true) {
                  $("#c" + i + "" + j).addClass('notEmpty');
                }
            }
        }
    }
    
    function makeMove() {
        setTimeout(function() {
            board = minimaxMove(board);
            console.log(numNodes);
            console.log('selected');
            console.log(board);
            myMove = false;
            updateMove();
        }, 600);
    }
    
    function minimaxMove(board) {
        numNodes = 0;
        return recurseMinimax(board, true)[1];
    }
    
    var numNodes = 0;
    
    function recurseMinimax(board, player) {
        numNodes++;
        var winner = getWinner(board);
        if (winner != null) {
            switch(winner) {
                case 1:
                    // AI wins
                    return [1, board]
                case 0:
                    // opponent wins
                    return [-1, board]
                case -1:
                    // Tie
                    return [0, board];
            }
        } else {
            // Next states
            var nextVal = null;
            var nextBoard = null;
            
            for (var i = 0; i < 3; i++) {
                for (var j = 0; j < 3; j++) {
                    if (board[i][j] == null) {
                        board[i][j] = player;
                        var value = recurseMinimax(board, !player)[0];
                        if ((player && (nextVal == null || value > nextVal)) || (!player && (nextVal == null || value < nextVal))) {
                            nextBoard = board.map(function(arr) {
                                return arr.slice();
                            });
                            nextVal = value;
                        }
                        board[i][j] = null;
                    }
                }
            }
            return [nextVal, nextBoard];
        }
    }
    
    updateMove();
    
    </script>>